<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<title>Electro Asistan</title>
<style>
  body { font-family: Arial, sans-serif; background:#f5f5f5; margin:0; padding:0; }
  #chat {
    display:flex; flex-direction:column; height:100vh; padding:10px;
  }
  #messages {
    flex:1; overflow-y:auto; padding:10px; background:white;
    border-radius:10px; margin-bottom:10px; font-size:14px;
  }
  #input-area {
    display:flex; gap:10px;
  }
  input {
    flex:1; padding:10px; border-radius:8px; border:1px solid #ccc;
  }
  button {
    background:#0d6efd; color:white; border:none; padding:10px 15px;
    border-radius:8px; cursor:pointer;
  }
</style>
</head>
<body>
<div id="chat">
  <div id="messages"></div>
  <div id="input-area">
    <input type="text" id="userInput" placeholder="Merhaba, nasÄ±l yardÄ±mcÄ± olabilirim?" />
    <button onclick="sendMessage()">GÃ¶nder</button>
  </div>
</div>

<script>
const apiURL = "https://electro-api-swart.vercel.app/api/products";

async function sendMessage() {
  const input = document.getElementById('userInput');
  const msgBox = document.getElementById('messages');
  const text = input.value.trim();
  if (!text) return;
  msgBox.innerHTML += `<div><b>ðŸ‘¤ Sen:</b> ${text}</div>`;
  input.value = "";

  // ÃœrÃ¼nleri getir
  const res = await fetch(apiURL);
  const data = await res.json();

  // Basit filtreleme
 // KullanÄ±cÄ±nÄ±n yazdÄ±ÄŸÄ±ndaki kelimeleri ayrÄ± ayrÄ± kontrol et
const terms = text.toLowerCase().split(" ").filter(t => t.length > 2);


  // AkÄ±llÄ± arama: hem kelimeleri hem sayÄ±larÄ±nÄ± dikkate alÄ±r
const terms = text.toLowerCase().split(" ").filter(t => t.length > 1);
const found = data.filter(p => {
  const name = `${p.name} ${p.category} ${p.brand}`.toLowerCase();

  // KullanÄ±cÄ± program sayÄ±sÄ± belirttiyse
  const numberMatch = text.match(/\d+/);
  if (numberMatch) {
    const num = numberMatch[0];
    if (!name.includes(num)) return false; // program sayÄ±sÄ± uymuyorsa ele
  }

  // Her kelime ad, kategori veya markada geÃ§meli
  return terms.every(term => name.includes(term));
});



  if (found.length > 0) {
    msgBox.innerHTML += `<div><b>ðŸ¤– Asistan:</b> ${found.length} Ã¼rÃ¼n buldum:</div>`;
    found.slice(0, 3).forEach(p => {
      msgBox.innerHTML += `
        <div style="margin:8px 0; padding:8px; border:1px solid #ddd; border-radius:8px;">
          <b>${p.name}</b><br>
          ${p.price} ${p.currency}<br>
          <a href="${p.url}" target="_blank">ÃœrÃ¼nÃ¼ GÃ¶r</a>
        </div>`;
    });
  } else {
    msgBox.innerHTML += `<div><b>ðŸ¤– Asistan:</b> Bu kriterde Ã¼rÃ¼n bulamadÄ±m.</div>`;
  }

  msgBox.scrollTop = msgBox.scrollHeight;
}
</script>
</body>
</html>


